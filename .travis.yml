dist: xenial
language: python
python: 3.7
install: pip install setuptools
before_script:
  - curl -L https://codeclimate.com/downloads/test-reporter/test-reporter-latest-linux-amd64 > ./cc-test-reporter
  - chmod +x ./cc-test-reporter
  - ./cc-test-reporter before-build
script: python setup.py pytest --addopts "--cov=judge0api --cov-report=xml"
after_script:
  - ./cc-test-reporter after-build --id 082afe93df2754b0c060ed4a564d5ec7b08ae5e73a47ad7bfd771b503771262f --exit-code $TRAVIS_TEST_RESULT

deploy:
  provider: pypi
  user: vCra
  password:
    secure: Vq/UHnj4GBRkXSJoJlIO/9bDtqRRoaz22SVZH9XZM9lG/35rFtJBuS1gAIhsqEnXT/q0/vDnWM7rQj6KpMOFDKMMX5tWb/LIEX2GTmvuuOIsKW765sdWvSnbvzqkMkSyn04XPZGcEYS7av+CTM94nA3QL2SIttf9yFoEt0bYAU/lBpTS2c5Hv6tPDjjno+4lnLxhE11AG/5+PO3nuyJbL7uKi1sf2ZZ4Xi9RNmp56cBohmPAN4raXxtcgqG/zMAWApzigW85zjzl0JHNHLdwH2A7WHbUK8gwxdHy28hqfJIA6fhsJpseiHhtIAtIgy9V6KLHW2FXqLlZCEFPGHGDNyvZIeGfG6IEdQBJH1IQmFnXMC7ONQjDaxs4C5cXFcp5YnH+8NqH9fz4VN4Xkz4UgEg2jGQjb2AzEMT1c3jvY/S7JJ8u7RZOj/FQNOtCJ8yTyDQi2+w4oMxamIHWf48JmB4te9RD3qlQVKNCtftj71n/Wg5Q/PjO9aHFAdEcuffc/9tQDNUob1/Er7Wr24hMtjIFm6fKg8eJzdgbY0tIoOErnJMv8lN4SdoAFGoebtmWMtY5DdkvO5VSOWIMMxPBV1Clg6RT+fVj3c5yAV3NWmW61r3aMng5iFhv3Z1zfTZFYtNwHAMk+UNODnL8zzBA+KPLBK9HyeM31Ow9PFJGV7k=
  on:
    tags: true
    branch: master
  distributions: sdist
