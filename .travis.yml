dist: xenial
language: python
python: 3.7
install: pip install setuptools
before_script:
- curl -L https://codeclimate.com/downloads/test-reporter/test-reporter-latest-linux-amd64
  > ./cc-test-reporter
- chmod +x ./cc-test-reporter
- "./cc-test-reporter before-build"
- 
script: python setup.py pytest --addopts "--cov=judge0api --cov-report=xml"

after_script:
- "./cc-test-reporter after-build --id 082afe93df2754b0c060ed4a564d5ec7b08ae5e73a47ad7bfd771b503771262f
  --exit-code $TRAVIS_TEST_RESULT"

deploy:
  provider: pypi
  user: vCra
  password:
    secure: D6foy2Xb1pzcInNzZlRpf+nGhrif0zx5mtyjGK2Lgo8DZrmggiS0OF4CTSs2p4iAId9YIj8RGeCQthyUA08FcJBLeTYJIF4SCzZWs94LS4hxnw7NhENblwm3rBldKXgwvPF3ObIPjgKTlFxNj9PjsRWMILCiIQBaaFlm4kHjL4g/DJELcz0kUkvV/M41n5GJ37917GhP1qjfLuHUqFrLauFLViuiiksNvyFxhVJEdRB6Yvy40kPxHzwxKwY1WVf6/yp9W/VtwAEMOas1cPrDgm5Eyi6x4P9PforoHlnFp1RPsdz8iEU+ZW64GdmyCu1JqgaojqkmHanvOsxLz3GK5jNSc+kDHnaDvaoJnurQhj2qCHy8zNcr6gDEmRGOrnaxV8vALRhZLnpkY8ibYU6f1C456PXWgVnNklBh2H2Jy0Fl+f80Dabv3gPiYYIuzWOSH3rUduGDsoKTzwSShwSHfoDs4zkWjZ1OGXoCo6J8Js16aNm/L4NhvP1rj1dq0d/7cRETNCKrxs0F5YXky7EALtriLfquMZSW0Zavi1uEnq1q297aYEYY/rDxVnkGrojRSm0mBdwPRlLZWtVIq5egdxm+K+PNJn5pE2dEIIyiP8T9vxHaTkFWInR0WYuCooGYcnvZ3wEE1CdAr47q9jUCq5EIFDbgyDndKF6EcoBmiBg=
  on:
    branch: master
  distributions: sdist
